<!DOCTYPE html>
<html>

<head>
<meta charset="UTF-8" />
<title>查询档案</title>
<style type="text/css">
</style>
</head>

<body style="text-align: center;">
	<div th:replace="base :: header"></div>
	<div>
		<form class="form-search" th:action="@{/query}" method="post">
			记账日期范围：<input type="text" id="datepicker1" name="recordDate1" class="input-medium search-query" /> 
			到<input type="text" id="datepicker2" name="recordDate2" class="input-medium search-query" /> 
			关键字：<input id="key" style="width:300px;" name="key" type="text" class="input-medium search-query" />
			<label class="radio"> <input type="radio" name="optionsRadios" id="option1" value="voucher" checked="checked"/>凭证</label> 
			<label class="radio"> <input type="radio" name="optionsRadios" id="option2" value="report" /> 日报 </label>
			<button  id="upload" class="btn btn-primary">搜索</button>
		</form>
	</div>

	<table class="table table-striped" style="width: 80%" align="center">
		<caption>最近上传凭证</caption>
		<thead>
			<tr>
				<td class="success">记账日期</td>
				<td class="warning">凭证图片</td>
				<td class="success">OCR内容</td>
				<td class="warning">上传者</td>
				<td class="warning">上传时间</td>
			</tr>
		</thead>
		<tbody>
			<div>
				<span
					th:if="${recentVouchers!=null and recentVouchers.content!=null}">
					<tr th:each="voucher: ${recentVouchers.content}">
						<td th:text="${#dates.format(voucher.recordDate,'yyyy-MM-dd')}"></td>
						<td><a th:href="@{'/voucher/voucher/'+${voucher.id}}"><img
								th:src="@{${voucher.imagePath}}" style="height: 50px;" /></a></td>
						<td style="width: 50%"
							th:text="${#strings.length(voucher.content)} &lt;150? ${voucher.content} : ${#strings.substring(voucher.content,0,150)}+'...'"></td>
						<td th:text="${voucher.user.username}"></td>
						<td
							th:text="${#dates.format(voucher.createTime,'yyyy-MM-dd　HH:mm:ss')}"></td>
						<td><a th:href="@{'/voucher/delete/'+${voucher.id}}">删除</a></td>
					</tr>
				</span>
			</div>
		</tbody>
	</table>

	<div th:replace="base :: footer"></div>
</body>

<script th:inline="javascript">
	$('#datepicker1').datepicker({
		todayBtn : "linked",
		language : "zh-CN",
		orientation : "bottom auto",
		autoclose : true
	})
	$('#datepicker2').datepicker({
		todayBtn : "linked",
		language : "zh-CN",
		orientation : "bottom auto",
		autoclose : true
	})

	// 校验记账日期和文件不为空
	$('#upload').on('click', function(e) {
		var recordDate1 = $("#datepicker1").val();
		var recordDate2 = $("#datepicker2").val();
		var key = $("#key").val();
		var radio = $("input[name='optionsRadios']:checked").val();
		
		if (recordDate1=="" || recordDate2==""){
			alert("必须选择记账日期范围")
		}else{
			$('#form-search').submit();	
		}
	});
</script>
</html>